{% extends "base.html" %}

{% block title %}è¨­å®šç®¡ç†{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}">
<script src="{{ url_for('static', filename='js/settings.js') }}" defer></script>
{% endblock %}

{% block content %}
<div class="settings-container">
  
  <h1 class="settings-title">è¨­å®šç®¡ç†</h1>
  
  {% if success %}
    <div class="settings-alert settings-alert-success">{{ success }}</div>
  {% endif %}
  {% if error %}
    <div class="settings-alert settings-alert-error">{{ error }}</div>
  {% endif %}
  
  <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
  <div class="settings-tabs">
    <button class="settings-tab-btn active" onclick="switchTab('notification')">é€šçŸ¥è¨­å®š</button>
    <button class="settings-tab-btn" onclick="switchTab('auto_call')">ã‚ªãƒ¼ãƒˆã‚³ãƒ¼ãƒ«</button>
    <button class="settings-tab-btn" onclick="switchTab('parking')">é§è»Šå ´</button>
    <button class="settings-tab-btn" onclick="switchTab('shift_types')">ã‚·ãƒ•ãƒˆç¨®åˆ¥</button>
    <button id="customer-info-tab" class="settings-tab-btn" onclick="switchTab('customer_info')">é¡§å®¢æƒ…å ±</button>
  </div>
  
  <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <form id="settingsForm">
    
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <!-- é€šçŸ¥è¨­å®šã‚¿ãƒ– -->
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <div id="notification" class="settings-tab-content active">
      <h2 class="settings-section-title">é€šçŸ¥è¨­å®š</h2>
      
      <!-- ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ -->
      <div class="settings-subsection">
        <h3 class="settings-subsection-title">ğŸ“§ ãƒ¡ãƒ¼ãƒ«é€šçŸ¥</h3>
        
        {% for setting in notification %}
          {% if setting.setting_key == 'email_notify_enabled' %}
            <div class="settings-form-group">
              <label class="settings-checkbox-label">
                <input 
                  type="checkbox" 
                  id="{{ setting.setting_key }}" 
                  name="{{ setting.setting_key }}"
                  {% if setting.setting_value == 'true' %}checked{% endif %}>
                <span>{{ setting.description }}</span>
              </label>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'notification_email' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                {{ setting.description }}
              </label>
              <input 
                type="email" 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}" 
                class="settings-input"
                value="{{ setting.setting_value or '' }}"
                placeholder="example@example.com">
              <small class="settings-help-text">ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®é€šçŸ¥ãŒã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å±Šãã¾ã™</small>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      
      <div class="settings-divider"></div>
      
      <!-- LINEé€šçŸ¥ -->
      <div class="settings-subsection">
        <h3 class="settings-subsection-title">ğŸ“± LINEé€šçŸ¥è¨­å®š</h3>
        <p class="settings-help-text" style="margin-bottom: 1rem; padding: 0.75rem; background-color: #e3f2fd; border-left: 4px solid #2196F3; border-radius: 4px;">
          <strong>ã€é€ä¿¡å…ƒã®è¨­å®šã€‘</strong><br>
          LINE Messaging APIã‚’ä½¿ç”¨ã—ã¦é€šçŸ¥ã‚’é€ä¿¡ã—ã¾ã™ã€‚ä»¥ä¸‹ã®Channel Access Tokenã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚<br><br>
          <strong>ã€å—ä¿¡å…ˆã®è¨­å®šã€‘</strong><br>
          â‘  <strong>ã‚¹ã‚¿ãƒƒãƒ•å€‹åˆ¥:</strong> ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã§ã‚¹ã‚¿ãƒƒãƒ•ã”ã¨ã«LINE IDã‚’ç™»éŒ²<br>
          â‘¡ <strong>åº—èˆ—å…±é€š:</strong> ä¸‹è¨˜ã®ã€Œåº—èˆ—ç”¨LINE IDã€ã«åº—èˆ—ã‚°ãƒ«ãƒ¼ãƒ—ã¾ãŸã¯æ‹…å½“è€…ã®LINE IDã‚’ç™»éŒ²
        </p>
        
        {% for setting in notification %}
          {% if setting.setting_key == 'line_notify_enabled' %}
            <div class="settings-form-group">
              <label class="settings-checkbox-label">
                <input 
                  type="checkbox" 
                  id="{{ setting.setting_key }}" 
                  name="{{ setting.setting_key }}"
                  {% if setting.setting_value == 'true' %}checked{% endif %}>
                <span>LINEé€šçŸ¥ã‚’æœ‰åŠ¹ã«ã™ã‚‹</span>
              </label>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'line_channel_access_token' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                LINE Channel Access Token <span style="color: #e74c3c; font-weight: bold;">*å¿…é ˆ</span>
              </label>
              <div class="settings-password-wrapper">
                <input 
                  type="password" 
                  id="{{ setting.setting_key }}" 
                  name="{{ setting.setting_key }}" 
                  class="settings-input"
                  value="{{ setting.setting_value or '' }}"
                  placeholder="Channel Access Tokenã‚’å…¥åŠ›ã—ã¦ãã ã•ã„">
                <button type="button" class="settings-show-btn" onclick="togglePassword('{{ setting.setting_key }}')">è¡¨ç¤º</button>
              </div>
              <small class="settings-help-text">
                ğŸ“– å–å¾—æ–¹æ³•: 
                <a href="https://developers.line.biz/console/" target="_blank" style="color: #06C755; font-weight: 500;">LINE Developers Console</a> 
                â†’ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é¸æŠ â†’ ãƒãƒ£ãƒãƒ«é¸æŠ â†’ ã€ŒMessaging APIè¨­å®šã€ã‚¿ãƒ– â†’ ã€ŒChannel access token (long-lived)ã€
              </small>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'line_channel_secret' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                LINE Channel Secret <span style="color: #6c757d;">ï¼ˆä»»æ„ãƒ»æ¨å¥¨ï¼‰</span>
              </label>
              <div class="settings-password-wrapper">
                <input 
                  type="password" 
                  id="{{ setting.setting_key }}" 
                  name="{{ setting.setting_key }}" 
                  class="settings-input"
                  value="{{ setting.setting_value or '' }}"
                  placeholder="Channel Secretã‚’å…¥åŠ›ã—ã¦ãã ã•ã„">
                <button type="button" class="settings-show-btn" onclick="togglePassword('{{ setting.setting_key }}')">è¡¨ç¤º</button>
              </div>
              <small class="settings-help-text">
                Webhookç½²åæ¤œè¨¼ç”¨ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ã®ãŸã‚è¨­å®šã‚’æ¨å¥¨ï¼‰
              </small>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'line_bot_id' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                LINE Bot ID <span style="color: #e74c3c; font-weight: bold;">*å¿…é ˆ</span>
              </label>
              <input 
                type="text" 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}" 
                class="settings-input"
                value="{{ setting.setting_value or '' }}"
                placeholder="@ã‹ã‚‰å§‹ã¾ã‚‹Bot IDï¼ˆä¾‹: @275gmabdï¼‰">
              <small class="settings-help-text">
                ğŸ“– ã‚¹ã‚¿ãƒƒãƒ•ãŒQRã‚³ãƒ¼ãƒ‰ã‹ã‚‰å‹ã ã¡è¿½åŠ ã™ã‚‹Bot IDã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚<br>
                LINE Official Account Manager â†’ è¨­å®š â†’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š â†’ ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ID ã§ç¢ºèªã§ãã¾ã™ã€‚
              </small>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'store_line_id' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                åº—èˆ—ç”¨LINE ID <span style="color: #6c757d;">ï¼ˆã‚ªãƒ¼ãƒˆã‚³ãƒ¼ãƒ«çµæœé€šçŸ¥ç”¨ï¼‰</span>
              </label>
              <input 
                type="text" 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}" 
                class="settings-input"
                value="{{ setting.setting_value or '' }}"
                placeholder="Uã‹ã‚‰å§‹ã¾ã‚‹LINE IDã‚’å…¥åŠ›">
              <small class="settings-help-text">
                ã‚ªãƒ¼ãƒˆã‚³ãƒ¼ãƒ«å®Ÿè¡Œçµæœã‚’å—ã‘å–ã‚‹LINE IDã‚’è¨­å®šï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ã¾ãŸã¯å€‹äººï¼‰
              </small>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'line_message_template' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                ã‚¹ã‚¿ãƒƒãƒ•ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
              </label>
              <textarea 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}" 
                class="settings-input settings-textarea"
                rows="4"
                placeholder="ã€ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã€‘&#10;ã‚­ãƒ£ã‚¹ãƒˆ: {name}ã•ã‚“&#10;é€€å®¤æ™‚åˆ»: {time}&#10;ãƒ›ãƒ†ãƒ«: {hotel}">{{ setting.setting_value or '' }}</textarea>
              <small class="settings-help-text">
                ä½¿ç”¨å¯èƒ½ãªå¤‰æ•°: <code>{name}</code> ã‚­ãƒ£ã‚¹ãƒˆåã€<code>{time}</code> é€€å®¤æ™‚åˆ»ã€<code>{hotel}</code> ãƒ›ãƒ†ãƒ«å
              </small>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'store_line_message_template' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                åº—èˆ—ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆã‚ªãƒ¼ãƒˆã‚³ãƒ¼ãƒ«çµæœé€šçŸ¥ï¼‰
              </label>
              <textarea 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}" 
                class="settings-input settings-textarea"
                rows="5"
                placeholder="ã€ã‚ªãƒ¼ãƒˆã‚³ãƒ¼ãƒ«{result}ã€‘&#10;{name}ã•ã‚“ã¸ã®ç™ºä¿¡{result_text}&#10;é€€å®¤äºˆå®š: {time}&#10;ç™ºä¿¡æ™‚åˆ»: {call_time}">{{ setting.setting_value or '' }}</textarea>
              <small class="settings-help-text">
                ä½¿ç”¨å¯èƒ½ãªå¤‰æ•°: <code>{result}</code> çµæœï¼ˆå®Œäº†/å¤±æ•—ï¼‰ã€<code>{result_text}</code> çµæœè©³ç´°ã€<code>{name}</code> ã‚­ãƒ£ã‚¹ãƒˆåã€<code>{time}</code> é€€å®¤æ™‚åˆ»ã€<code>{call_time}</code> ç™ºä¿¡æ™‚åˆ»
              </small>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      
      <div class="settings-button-group">
        <button type="button" class="settings-btn settings-btn-primary" onclick="saveNotificationSettings()">ä¿å­˜</button>
      </div>
    </div>
    
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <!-- ã‚ªãƒ¼ãƒˆã‚³ãƒ¼ãƒ«ã‚¿ãƒ– -->
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <div id="auto_call" class="settings-tab-content">
      <h2 class="settings-section-title">ã‚ªãƒ¼ãƒˆã‚³ãƒ¼ãƒ«</h2>
      
      {% for setting in auto_call %}
        {% if setting.setting_key == 'auto_call_enabled' %}
          <div class="settings-form-group">
            <label class="settings-checkbox-label">
              <input 
                type="checkbox" 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}"
                {% if setting.setting_value == 'true' %}checked{% endif %}>
              <span>{{ setting.description }}</span>
            </label>
          </div>
          <div class="settings-divider"></div>
        {% endif %}
      {% endfor %}
      
      <!-- Twilioæ¥ç¶šæƒ…å ± -->
      <div class="settings-subsection">
        <h3 class="settings-subsection-title">ğŸ“ æ¥ç¶šæƒ…å ±</h3>
        
        {% for setting in auto_call %}
          {% if setting.setting_key in ['twilio_account_sid', 'twilio_auth_token'] %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                {{ setting.description }}
              </label>
              <div class="settings-password-wrapper">
                <input 
                  type="password" 
                  id="{{ setting.setting_key }}" 
                  name="{{ setting.setting_key }}" 
                  class="settings-input"
                  value="{{ setting.setting_value or '' }}"
                  placeholder="{{ setting.description }}">
                <button type="button" class="settings-show-btn" onclick="togglePassword('{{ setting.setting_key }}')">è¡¨ç¤º</button>
              </div>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'twilio_phone_number' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                {{ setting.description }}
              </label>
              <input 
                type="text" 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}" 
                class="settings-input"
                value="{{ setting.setting_value or '' }}"
                placeholder="+1 (815) 686-1213">
            </div>
          {% endif %}
        {% endfor %}
      </div>
      
      <div class="settings-divider"></div>
      
      <!-- é€šè©±è¨­å®š -->
      <div class="settings-subsection">
        <h3 class="settings-subsection-title">âš™ï¸ é€šè©±è¨­å®š</h3>
        
        {% for setting in auto_call %}
          {% if setting.setting_key == 'default_reminder_minutes' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                {{ setting.description }}
              </label>
              <div class="settings-input-with-unit">
                <input 
                  type="number" 
                  id="{{ setting.setting_key }}" 
                  name="{{ setting.setting_key }}" 
                  class="settings-input settings-input-number"
                  value="{{ setting.setting_value or '15' }}"
                  min="1"
                  max="60">
                <span class="settings-unit">åˆ†å‰</span>
              </div>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'call_timeout_seconds' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                {{ setting.description }}
              </label>
              <div class="settings-input-with-unit">
                <input 
                  type="number" 
                  id="{{ setting.setting_key }}" 
                  name="{{ setting.setting_key }}" 
                  class="settings-input settings-input-number"
                  value="{{ setting.setting_value or '15' }}"
                  min="5"
                  max="60">
                <span class="settings-unit">ç§’ï¼ˆç´„3ã‚³ãƒ¼ãƒ«ï¼‰</span>
              </div>
            </div>
          {% endif %}
          
          {% if setting.setting_key == 'call_message_template' %}
            <div class="settings-form-group">
              <label for="{{ setting.setting_key }}" class="settings-label">
                {{ setting.description }}
              </label>
              <textarea 
                id="{{ setting.setting_key }}" 
                name="{{ setting.setting_key }}" 
                class="settings-input settings-textarea"
                rows="3"
                placeholder="éŸ³å£°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸">{{ setting.setting_value or '' }}</textarea>
              <small class="settings-help-text">
                ä½¿ç”¨å¯èƒ½ãªå¤‰æ•°: {name} - ã‚­ãƒ£ã‚¹ãƒˆå
              </small>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      
      <div class="settings-divider"></div>
      
      <!-- ãƒ†ã‚¹ãƒˆç™ºä¿¡ -->
      <div class="settings-subsection">
        <h3 class="settings-subsection-title">ğŸ§ª ãƒ†ã‚¹ãƒˆç™ºä¿¡</h3>
        
        <div class="settings-form-group">
          <label for="test_phone_number" class="settings-label">ãƒ†ã‚¹ãƒˆç”¨é›»è©±ç•ªå·</label>
          <input 
            type="tel" 
            id="test_phone_number" 
            class="settings-input"
            placeholder="090-1234-5678">
          <small class="settings-help-text">
            ç™ºä¿¡å…ƒç•ªå· {{ auto_call[3].setting_value if auto_call|length > 3 else '+18156861213' }} ã‹ã‚‰ãƒ†ã‚¹ãƒˆç™ºä¿¡ã—ã¾ã™
          </small>
        </div>
        
        <button type="button" class="settings-btn settings-btn-secondary" onclick="testCall()">
          ğŸ“ ãƒ†ã‚¹ãƒˆç™ºä¿¡ã™ã‚‹
        </button>
        
        <div id="testCallResult" class="settings-test-result"></div>
      </div>
      
      <div class="settings-divider"></div>
      
      <div class="settings-button-group">
        <button type="button" class="settings-btn settings-btn-primary" onclick="saveAutoCallSettings()">ä¿å­˜</button>
      </div>
    </div>
    
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <!-- é§è»Šå ´ã‚¿ãƒ– -->
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <div id="parking" class="settings-tab-content">
      <h2 class="settings-section-title">é§è»Šå ´</h2>
      
      <!-- é§è»Šå ´æ©Ÿèƒ½ON/OFF -->
      <div class="settings-form-group">
        <label class="settings-checkbox-label">
          <input 
            type="checkbox" 
            id="parking_enabled" 
            name="parking_enabled"
            {% if parking_enabled %}checked{% endif %}
            onchange="toggleParkingFeature(this.checked)">
          <span>é§è»Šå ´ç®¡ç†æ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹</span>
        </label>
      </div>
      
      <div class="settings-divider"></div>
      
      <!-- é§è»Šå ´ä¸€è¦§ -->
      <div id="parkingListSection" style="display: none;">
        <div class="settings-subsection">
          <h3 class="settings-subsection-title">ğŸ…¿ï¸ ç™»éŒ²æ¸ˆã¿é§è»Šå ´</h3>
          
          <div id="parkingList" class="parking-list">
            <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
          </div>
          
          <button type="button" class="settings-btn settings-btn-secondary" onclick="showAddParkingModal()">
            â• é§è»Šå ´ã‚’è¿½åŠ 
          </button>
        </div>
      </div>
    </div>
    
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <!-- ã‚·ãƒ•ãƒˆç¨®åˆ¥ã‚¿ãƒ– -->
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <div id="shift_types" class="settings-tab-content">
      <h2 class="settings-section-title">ã‚·ãƒ•ãƒˆç¨®åˆ¥</h2>
      
      <!-- ã‚·ãƒ•ãƒˆç¨®åˆ¥ä¸€è¦§ -->
      <div class="settings-subsection">
        <h3 class="settings-subsection-title">ğŸ“… ç™»éŒ²æ¸ˆã¿ã‚·ãƒ•ãƒˆç¨®åˆ¥</h3>
        
        <div id="shiftTypeList" class="shift-type-list">
          <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
        </div>
        
        <button type="button" class="settings-btn settings-btn-secondary" onclick="showAddShiftTypeModal()">
          â• ã‚·ãƒ•ãƒˆç¨®åˆ¥ã‚’è¿½åŠ 
        </button>
      </div>
    </div>
    
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <!-- é¡§å®¢æƒ…å ±ã‚¿ãƒ– -->
    <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
    <div id="customer_info" class="settings-tab-content">
      <h2 class="settings-section-title">é¡§å®¢æƒ…å ±</h2>
      
      <div class="settings-subsection">
        <p class="settings-help-text">
          é¡§å®¢ç™»éŒ²ãƒ»ç·¨é›†ã§ä½¿ç”¨ã™ã‚‹é¸æŠè‚¢ã‚’ç®¡ç†ã—ã¾ã™ã€‚å„é …ç›®ã«è‰²ã‚’è¨­å®šã§ãã€é¡§å®¢ä¸€è¦§ã‚„ç·¨é›†ç”»é¢ã§è‰²åˆ†ã‘è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
        </p>
        
        <div id="customerFieldsContainer" class="customer-fields-container">
          <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
          <div class="settings-loading">èª­ã¿è¾¼ã¿ä¸­...</div>
        </div>
      </div>
    </div>
    
  </form>
  
  <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
  <div id="saveMessage" class="settings-message"></div>
  
</div>

<!-- é§è»Šå ´è¿½åŠ ãƒ»ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="parkingModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="parkingModalTitle">é§è»Šå ´ã‚’è¿½åŠ </h3>
      <span class="modal-close" onclick="closeParkingModal()">&times;</span>
    </div>
    
    <div class="modal-body">
      <div class="settings-form-group">
        <label for="parkingNameInput" class="settings-label">é§è»Šå ´å</label>
        <input 
          type="text" 
          id="parkingNameInput" 
          class="settings-input"
          placeholder="ä¾‹: P1, é§…å‰ãƒ‘ãƒ¼ã‚­ãƒ³ã‚°"
          maxlength="50">
      </div>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="settings-btn settings-btn-secondary" onclick="closeParkingModal()">
        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      </button>
      <button type="button" class="settings-btn settings-btn-primary" onclick="saveParkingLot()">
        ä¿å­˜
      </button>
    </div>
  </div>
</div>

<!-- ã‚·ãƒ•ãƒˆç¨®åˆ¥è¿½åŠ ãƒ»ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="shiftTypeModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="shiftTypeModalTitle">ã‚·ãƒ•ãƒˆç¨®åˆ¥ã‚’è¿½åŠ </h3>
      <span class="modal-close" onclick="closeShiftTypeModal()">&times;</span>
    </div>
    
    <div class="modal-body">
      <div class="settings-form-group">
        <label for="shiftTypeNameInput" class="settings-label">ã‚·ãƒ•ãƒˆå</label>
        <input 
          type="text" 
          id="shiftTypeNameInput" 
          class="settings-input"
          placeholder="ä¾‹: æ—©ç•ªã€é…ç•ªã€å¤œå‹¤"
          maxlength="50">
      </div>
      
      <div class="settings-form-group">
        <label class="settings-checkbox-label">
          <input 
            type="checkbox" 
            id="shiftTypeIsWorkDay"
            checked>
          <span>å‡ºå‹¤æ—¥ã¨ã—ã¦æ‰±ã†ï¼ˆä¼‘æ—¥ã®å ´åˆã¯ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã™ï¼‰</span>
        </label>
      </div>
      
      <div class="settings-form-group">
        <label for="shiftTypeColorInput" class="settings-label">è¡¨ç¤ºè‰²</label>
        <div class="color-picker-wrapper">
          <input 
            type="color" 
            id="shiftTypeColorInput" 
            class="color-input"
            value="#4CAF50">
          <input 
            type="text" 
            id="shiftTypeColorText" 
            class="settings-input color-text-input"
            value="#4CAF50"
            maxlength="7"
            pattern="^#[0-9A-Fa-f]{6}$">
        </div>
      </div>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="settings-btn settings-btn-secondary" onclick="closeShiftTypeModal()">
        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      </button>
      <button type="button" class="settings-btn settings-btn-primary" onclick="saveShiftType()">
        ä¿å­˜
      </button>
    </div>
  </div>
</div>

<!-- ã‚«ãƒ†ã‚´ãƒªåç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="categoryEditModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>ã‚«ãƒ†ã‚´ãƒªåã‚’å¤‰æ›´</h3>
      <span class="modal-close" onclick="closeCategoryEditModal()">&times;</span>
    </div>
    
    <div class="modal-body">
      <div class="settings-form-group">
        <label for="categoryLabelInput" class="settings-label">æ–°ã—ã„åå‰</label>
        <input 
          type="text" 
          id="categoryLabelInput" 
          class="settings-input"
          placeholder="ä¾‹: ãƒ©ãƒ³ã‚¯ã€ã‚°ãƒ¬ãƒ¼ãƒ‰"
          maxlength="50">
      </div>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="settings-btn settings-btn-secondary" onclick="closeCategoryEditModal()">
        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      </button>
      <button type="button" class="settings-btn settings-btn-primary" onclick="saveCategoryLabel()">
        ä¿å­˜
      </button>
    </div>
  </div>
</div>

<!-- é¸æŠè‚¢è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="optionAddModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>é …ç›®ã‚’è¿½åŠ </h3>
      <span class="modal-close" onclick="closeOptionAddModal()">&times;</span>
    </div>
    
    <div class="modal-body">
      <div class="settings-form-group">
        <label for="optionValueInput" class="settings-label">é …ç›®å</label>
        <input 
          type="text" 
          id="optionValueInput" 
          class="settings-input"
          placeholder="ä¾‹: VIPä¼šå“¡"
          maxlength="100">
      </div>
      
      <div class="settings-form-group">
        <label for="optionColorInput" class="settings-label">è¡¨ç¤ºè‰²</label>
        <div class="color-picker-group">
          <input 
            type="color" 
            id="optionColorInput" 
            class="color-input"
            value="#f0f0f0"
            onchange="updateColorPreview('optionColorInput', 'optionColorPreview')">
          <span id="optionColorPreview" class="color-preview" style="background-color: #f0f0f0;">#f0f0f0</span>
        </div>
      </div>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="settings-btn settings-btn-secondary" onclick="closeOptionAddModal()">
        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      </button>
      <button type="button" class="settings-btn settings-btn-primary" onclick="saveNewOption()">
        è¿½åŠ 
      </button>
    </div>
  </div>
</div>

<script>
// URLã‚’è¨­å®š
window.settingsUrls = {
  store: "/{{ store }}",
  save: "/{{ store }}/settings/save",
  testCall: "/{{ store }}/settings/test_call"
};
</script>
<script src="{{ url_for('static', filename='js/settings.js') }}"></script>
<script src="{{ url_for('static', filename='js/settings_customer.js') }}"></script>

{% endblock %}