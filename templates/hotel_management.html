{% extends "base.html" %}

{% block title %}ホテル管理{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/hotel_management.css') }}">
{% endblock %}

{% block content %}
<div class="hotel-container">
  
  <h1 class="hotel-title">ホテル管理</h1>
  
  <div id="message-container"></div>
  
  <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
  <!-- 上部：2カラムレイアウト（種別管理 + エリア管理） -->
  <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
  <div class="hotel-settings-grid">
    
    <!-- 左列：ホテル管理種別 -->
    <div class="hotel-settings-section">
      <div class="hotel-section-header">
        <h2 class="hotel-section-title">ホテル管理種別</h2>
        <button type="button" class="hotel-btn hotel-btn-primary" id="add-hotel-type-btn">
          新規追加
        </button>
      </div>
      
      <div class="hotel-table-wrapper">
        <table class="hotel-table">
          <thead>
            <tr>
              <th style="width: 60%;">種別名</th>
              <th style="width: 20%;">編集</th>
              <th style="width: 20%;">削除</th>
            </tr>
          </thead>
          <tbody id="hotel-types-tbody">
            <tr>
              <td colspan="3" class="hotel-table-loading">読み込み中...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- 右列：エリア管理 -->
    <div class="hotel-settings-section">
      <div class="hotel-section-header">
        <h2 class="hotel-section-title">エリア管理</h2>
        <button type="button" class="hotel-btn hotel-btn-primary" id="add-area-btn">
          新規追加
        </button>
      </div>
      
      <div class="hotel-table-wrapper">
        <table class="hotel-table">
          <thead>
            <tr>
              <th style="width: 15%;">並び順</th>
              <th style="width: 30%;">エリア名</th>
              <th style="width: 20%;">交通費</th>
              <th style="width: 20%;">所要時間</th>
              <th style="width: 7.5%;">編集</th>
              <th style="width: 7.5%;">削除</th>
            </tr>
          </thead>
          <tbody id="areas-tbody">
            <tr>
              <td colspan="6" class="hotel-table-loading">読み込み中...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
  </div>
  
  <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
  <!-- ホテル登録フォーム -->
  <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
  <div class="hotel-form-section">
    <h2 class="hotel-section-title">ホテル登録</h2>
    
    <div class="hotel-form-card">
      <form id="hotel-form">
        <div class="hotel-form-grid">
          <div class="hotel-form-group">
            <label class="hotel-form-label">
              ホテル名 <span class="hotel-required">*</span>
            </label>
            <input type="text" id="hotel-name" class="hotel-form-input" 
                   placeholder="例: グランドホテル東京" required>
          </div>
          
          <div class="hotel-form-group">
            <label class="hotel-form-label">
              種別 <span class="hotel-required">*</span>
            </label>
            <select id="hotel-type" class="hotel-form-input" required>
              <option value="">選択してください</option>
            </select>
          </div>
          
          <div class="hotel-form-group">
            <label class="hotel-form-label">
              エリア <span class="hotel-required">*</span>
            </label>
            <select id="hotel-area" class="hotel-form-input" required>
              <option value="">選択してください</option>
            </select>
          </div>
        </div>
        
        <div class="hotel-form-buttons">
          <button type="button" class="hotel-btn-reset" onclick="resetHotelForm()">
            クリア
          </button>
          <button type="submit" class="hotel-btn-submit">
            登録
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
  <!-- ホテル一覧 -->
  <!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
  <div class="hotel-list-section">
    <h2 class="hotel-section-title">登録済みホテル一覧</h2>
    
    <div class="hotel-list-card">
      <div class="hotel-table-wrapper">
        <table class="hotel-table">
          <thead>
            <tr>
              <th style="width: 15%;">並び順</th>
              <th style="width: 30%;">ホテル名</th>
              <th style="width: 20%;">種別</th>
              <th style="width: 20%;">エリア</th>
              <th style="width: 7.5%;">編集</th>
              <th style="width: 7.5%;">削除</th>
            </tr>
          </thead>
          <tbody id="hotels-tbody">
            <tr>
              <td colspan="6" class="hotel-table-loading">読み込み中...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  
  <!-- メッセージ表示エリア -->
  <div id="saveMessage" class="hotel-message"></div>
  
</div>

<!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
<!-- モーダル1: ホテル管理種別追加・編集 -->
<!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
<div id="hotel-type-modal" class="hotel-modal">
  <div class="hotel-modal-dialog">
    <div class="hotel-modal-content">
      <div class="hotel-modal-header">
        <h3 class="hotel-modal-title" id="hotel-type-modal-title">ホテル管理種別を追加</h3>
        <span class="hotel-modal-close" onclick="closeHotelTypeModal()">&times;</span>
      </div>
      <div class="hotel-modal-body">
        <form id="hotel-type-form" onsubmit="saveHotelType(event)">
          <input type="hidden" id="hotel-type-id">
          
          <div class="hotel-modal-group">
            <label class="hotel-modal-label">
              種別名 <span class="hotel-required">*</span>
            </label>
            <input type="text" id="hotel-type-name" class="hotel-modal-input" 
                   placeholder="例: ビジネスホテル" required>
          </div>
          
          <div class="hotel-modal-footer">
            <button type="button" class="hotel-modal-btn-cancel" onclick="closeHotelTypeModal()">
              キャンセル
            </button>
            <button type="submit" class="hotel-modal-btn-save">
              保存
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
<!-- モーダル2: エリア追加・編集 -->
<!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
<div id="area-modal" class="hotel-modal">
  <div class="hotel-modal-dialog">
    <div class="hotel-modal-content">
      <div class="hotel-modal-header">
        <h3 class="hotel-modal-title" id="area-modal-title">エリアを追加</h3>
        <span class="hotel-modal-close" onclick="closeAreaModal()">&times;</span>
      </div>
      <div class="hotel-modal-body">
        <form id="area-form" onsubmit="saveArea(event)">
          <input type="hidden" id="area-id">
          
          <div class="hotel-modal-group">
            <label class="hotel-modal-label">
              エリア名 <span class="hotel-required">*</span>
            </label>
            <input type="text" id="area-name" class="hotel-modal-input" 
                   placeholder="例: 新宿区" required>
          </div>
          
          <div class="hotel-modal-group">
            <label class="hotel-modal-label">
              交通費（円）
            </label>
            <input type="number" id="area-fee" class="hotel-modal-input" 
                   placeholder="例: 500" min="0">
          </div>
          
          <div class="hotel-modal-group">
            <label class="hotel-modal-label">
              所要時間（分）
            </label>
            <input type="number" id="area-time" class="hotel-modal-input" 
                   placeholder="例: 30" min="0">
          </div>
          
          <div class="hotel-modal-footer">
            <button type="button" class="hotel-modal-btn-cancel" onclick="closeAreaModal()">
              キャンセル
            </button>
            <button type="submit" class="hotel-modal-btn-save">
              保存
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
<!-- モーダル3: ホテル編集 -->
<!-- ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ -->
<div id="hotel-edit-modal" class="hotel-modal">
  <div class="hotel-modal-dialog">
    <div class="hotel-modal-content">
      <div class="hotel-modal-header">
        <h3 class="hotel-modal-title">ホテル情報を編集</h3>
        <span class="hotel-modal-close" onclick="closeHotelEditModal()">&times;</span>
      </div>
      <div class="hotel-modal-body">
        <form id="hotel-edit-form" onsubmit="updateHotel(event)">
          <input type="hidden" id="edit-hotel-id">
          
          <div class="hotel-modal-group">
            <label class="hotel-modal-label">
              ホテル名 <span class="hotel-required">*</span>
            </label>
            <input type="text" id="edit-hotel-name" class="hotel-modal-input" required>
          </div>
          
          <div class="hotel-modal-group">
            <label class="hotel-modal-label">
              種別 <span class="hotel-required">*</span>
            </label>
            <select id="edit-hotel-type" class="hotel-modal-input" required>
              <option value="">選択してください</option>
            </select>
          </div>
          
          <div class="hotel-modal-group">
            <label class="hotel-modal-label">
              エリア <span class="hotel-required">*</span>
            </label>
            <select id="edit-hotel-area" class="hotel-modal-input" required>
              <option value="">選択してください</option>
            </select>
          </div>
          
          <div class="hotel-modal-footer">
            <button type="button" class="hotel-modal-btn-cancel" onclick="closeHotelEditModal()">
              キャンセル
            </button>
            <button type="submit" class="hotel-modal-btn-save">
              更新
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
// URLを設定
window.hotelManagementUrls = {
  store: "/{{ store }}",
  hotelTypes: "/{{ store }}/hotel-management/hotel_types",
  areas: "/{{ store }}/hotel-management/areas",
  hotels: "/{{ store }}/hotel-management/hotels"
};
</script>
<script src="{{ url_for('static', filename='js/hotel_management.js') }}"></script>

{% endblock %}